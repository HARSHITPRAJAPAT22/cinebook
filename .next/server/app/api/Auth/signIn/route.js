(()=>{var e={};e.id=389,e.ids=[389],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},12518:e=>{"use strict";e.exports=require("mongodb")},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{"use strict";e.exports=require("crypto")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},79428:e=>{"use strict";e.exports=require("buffer")},95795:(e,s,r)=>{"use strict";r.r(s),r.d(s,{patchFetch:()=>k,routeModule:()=>w,serverHooks:()=>h,workAsyncStorage:()=>v,workUnitAsyncStorage:()=>f});var t={};r.r(t),r.d(t,{POST:()=>g});var n=r(96559),o=r(48088),i=r(37719),a=r(32190),u=r(12518),p=r(85663),c=r(43205),d=r.n(c);let l="mongodb+srv://aditivyasw:ZxE67PES9RTUJQEF@cinebook.9dfgnar.mongodb.net/",m="cinebook",x="cinebook_secret_key";if(!l||!m||!x)throw Error("Missing required environment variables");async function g(e){let{email:s,password:r}=await e.json(),t=new u.MongoClient(l);try{await t.connect();let e=t.db(m).collection("Users"),n=await e.findOne({email:s});if(!n)return a.NextResponse.json({success:!1,message:"Invalid email or password"},{status:401});if(n.googleId||n.facebookId){if(n.password){if(!await p.Ay.compare(r,n.password))return a.NextResponse.json({success:!1,message:"Invalid email or password"},{status:401});let e=d().sign({id:n._id,name:n.name,email:n.email},x,{expiresIn:"7d"});return a.NextResponse.json({success:!0,user:{id:n._id,name:n.name,email:n.email},token:e})}return a.NextResponse.json({success:!1,message:"User already exists with Google or Facebook account. Please sign in using those methods."},{status:409})}if(!await p.Ay.compare(r,n.password))return a.NextResponse.json({success:!1,message:"Invalid email or password"},{status:401});let o=d().sign({id:n._id,name:n.name,email:n.email},x,{expiresIn:"7d"});return a.NextResponse.json({success:!0,user:{id:n._id,name:n.name,email:n.email},token:o})}catch(e){return console.error("SignIn error:",e),a.NextResponse.json({success:!1,message:"Server error"},{status:500})}finally{await t.close()}}let w=new n.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/Auth/signIn/route",pathname:"/api/Auth/signIn",filename:"route",bundlePath:"app/api/Auth/signIn/route"},resolvedPagePath:"C:\\Users\\Lenovo\\Desktop\\cinebook\\app\\api\\Auth\\signIn\\route.ts",nextConfigOutput:"",userland:t}),{workAsyncStorage:v,workUnitAsyncStorage:f,serverHooks:h}=w;function k(){return(0,i.patchFetch)({workAsyncStorage:v,workUnitAsyncStorage:f})}},96487:()=>{}};var s=require("../../../../webpack-runtime.js");s.C(e);var r=e=>s(s.s=e),t=s.X(0,[447,580,205,663],()=>r(95795));module.exports=t})();