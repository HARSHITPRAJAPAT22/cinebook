(()=>{var e={};e.id=155,e.ids=[155],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},12518:e=>{"use strict";e.exports=require("mongodb")},15916:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>v,routeModule:()=>p,serverHooks:()=>f,workAsyncStorage:()=>m,workUnitAsyncStorage:()=>x});var o={};t.r(o),t.d(o,{POST:()=>g});var s=t(96559),n=t(48088),i=t(37719),a=t(32190),u=t(12518),d=t(43205),l=t.n(d);let c="cinebook_secret_key";async function g(e){let{name:r,email:t,googleId:o,facebookId:s,authProvider:n}=await e.json(),i=new u.MongoClient("mongodb+srv://aditivyasw:ZxE67PES9RTUJQEF@cinebook.9dfgnar.mongodb.net/");try{await i.connect();let e=i.db("cinebook").collection("Users");if(o){let r=await e.findOne({googleId:o});if(r){let e=l().sign({id:r._id.toString(),name:r.name,email:r.email},c,{expiresIn:"7d"});return a.NextResponse.json({success:!0,user:{id:r._id,name:r.name,email:r.email,googleId:r.googleId,facebookId:r.facebookId||null,authProvider:r.authProvider||"google"},token:e})}}if(await e.findOne({email:t})){await e.updateOne({email:t},{$set:{googleId:o||null,authProvider:"google"}});let r=await e.findOne({email:t});if(!r)return a.NextResponse.json({success:!1,message:"User not found after update."},{status:404});let s=l().sign({id:r._id.toString(),name:r.name,email:r.email},c,{expiresIn:"7d"});return a.NextResponse.json({success:!0,user:{id:r._id,name:r.name,email:r.email,googleId:r.googleId,facebookId:r.facebookId||null,authProvider:r.authProvider||"google"},token:s})}let u=await e.insertOne({name:r,email:t,password:"",googleId:o||null,facebookId:s||null,authProvider:n||"google"}),d=l().sign({id:u.insertedId.toString(),name:r,email:t},c,{expiresIn:"7d"});return a.NextResponse.json({success:!0,user:{id:u.insertedId,name:r,email:t,googleId:o||null,facebookId:s||null,authProvider:n||"google"},token:d})}catch(e){return console.error("Google Auth error:",e),a.NextResponse.json({success:!1,message:"Server error"},{status:500})}finally{await i.close()}}let p=new s.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/auth/google/route",pathname:"/auth/google",filename:"route",bundlePath:"app/auth/google/route"},resolvedPagePath:"C:\\Users\\Lenovo\\Desktop\\cinebook\\app\\auth\\google\\route.ts",nextConfigOutput:"",userland:o}),{workAsyncStorage:m,workUnitAsyncStorage:x,serverHooks:f}=p;function v(){return(0,i.patchFetch)({workAsyncStorage:m,workUnitAsyncStorage:x})}},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{"use strict";e.exports=require("crypto")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},79428:e=>{"use strict";e.exports=require("buffer")},96487:()=>{}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[447,580,205],()=>t(15916));module.exports=o})();